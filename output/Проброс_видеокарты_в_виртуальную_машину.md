–ü—Ä–æ–±—Ä–æ—Å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É.

–í —Ü–µ–ª–æ–º, —è –æ—Å—Ç–∞–≤–ª—é —Ç—É—Ç –≤—Å–µ, —á—Ç–æ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤ —Ç–µ—á–µ–Ω–∏–µ —É–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—
–º–µ—Å—è—Ü–µ–≤ –¥–ª—è —Å–≤–æ–µ–≥–æ –∫–æ–º–ø–∞, —á—Ç–æ–±—ã —Ç–µ, –∫—Ç–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –≤ –≥–æ—Å—Ç–µ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –º–æ–≥–ª–∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —á—Ç–æ –∫ —á–µ–º—É =)

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É –≤–Ω—É—Ç—Ä–∏ xen –∏–ª–∏ kvm –Ω—É–∂–Ω—ã
—Å–ª–µ–¥—É—é—â–∏–µ –≤–µ—â–∏:

1.  –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ AMD –¥–ª—è –≥–æ—Å—Ç–µ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –ª—é–±–∞—è.
    [–í–∏–¥–µ–æ–∫–∞—Ä—Ç—ã Nvidia –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ–¥—É–∫—Ü–∏–∏ —ç—Ç–æ–π
    –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ
    –ø—Ä–∏–≤—ã–∫–∞—Ç—å.](http://korzik.net/uploads/posts/1179252844_15_podborka_37.jpg)

<!-- end list -->

1.  –õ—é–±–∞—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –¥–ª—è —Ö–æ—Å—Ç–∞. –ö–æ–Ω–µ—á–Ω–æ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –∏ –æ–¥–Ω–æ–π, –Ω–æ —Ç–æ–≥–¥–∞
    —Ç–µ—Ä—è–µ—Ç—Å—è –≤–µ—Å—å —Å–º—ã—Å–ª –∑–∞—Ç–µ–∏.

<!-- end list -->

1.  –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞ —Å –±–ª–æ–∫–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞(IOMMU)

::\* –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤/—á–∏–ø—Å–µ—Ç–æ–≤ –æ—Ç AMD —ç—Ç–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
AMD-Vi –∏ –≤–∞–∂–µ–Ω —Ç–æ–ª—å–∫–æ —á–∏–ø—Å–µ—Ç. –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —ç—Ç–æ 890FX, –∏ –ø–æ –∏–¥–µ–µ –≤—Å—è
—Å–µ—Ä–∏—è 990 —á–∏–ø—Å–µ—Ç–æ–≤. –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º, –Ω–æ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å
–∞–ø–ø–∞—Ä–∞—Ç–Ω—É—é –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é(AMD-V).

::\* –í —Å–ª—É—á–∞–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤/—á–∏–ø—Å–µ—Ç–æ–≤ –æ—Ç Intel —ç—Ç–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
VT-d –∏ –≤–∞–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞–∫ –≤ —á–∏–ø—Å–µ—Ç–µ, —Ç–∞–∫ –∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ.

::\* –í –Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ –±–∏–æ—Å–µ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ø–ª–∞—Ç—ã
–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã IVRS/DMAR —Ç–∞–±–ª–∏—Ü—ã. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞,
–ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–æ–π –ø–ª–∞—Ç—ã, –ª—É—á—à–µ –ø–æ–≥—É–≥–ª–∏—Ç—å –Ω–∞—Å—á–µ—Ç —É—Å–ø–µ—Ö–æ–≤
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è iommu –Ω–∞ –¥–∞–Ω–Ω–æ–π –ø–ª–∞—Ç–µ.

  -
    –ñ–µ–ª–µ–∑–æ, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —É –º–µ–Ω—è:

::\* –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞: Gigabyte GA-990FXA-D3

::\* –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞: Msi Twin Razr III R7870

::\* –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: AMD Phenom II x6 1090T

::\* –Ø–¥—Ä–æ: 3.4

::\* xen 4.1.2

::\* kvm 1.0.1

-----

–ü–æ–¥–≥–æ–≤—Ç–æ–∫–∞ –∫ –ø—Ä–æ–±—Ä–æ—Å—É.

–≠—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏, –º—ã
–ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É –∫ –ø—Ä–æ–±—Ä–æ—Å—É –∏ –ø—Ä–∏–º–µ–Ω–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—Å—Ç—ã–ª–∏
–¥–ª—è –æ–±—Ö–æ–¥–∞ –±–∞–≥–æ–≤.

–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –≤ –±–∏–æ—Å –∏ –≤–∫–ª—é—á–∏—Ç—å —Ç–∞–º IOMMU. –¢–∞–∫ –∂–µ –Ω–∞–¥–æ
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç—É –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è —Ö–æ—Å—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ
–æ—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è —Ö–æ—Å—Ç–∞ +) —Ç.–µ. —á—Ç–æ–±—ã —Å–∞–º POST –±–∏–æ—Å–∞ –ø—Ä–æ—Ö–æ–¥–∏–ª –Ω–∞ —Ç–æ–π
–≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ, –∫–æ—Ç–æ—Ä–∞—è **–ù–ï** –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ –≤ –≥–æ—Å—Ç–µ–≤—É—é
—Å–∏—Å—Ç–µ–º—É.

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å, –Ω–∞–¥–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ IOMMU –≤–æ–æ–±—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–∫:

`dmesg¬†|¬†grep¬†-iE¬†"(iommu|vt-d)"¬†-a1`

–ê –µ—Å–ª–∏ –≤—ã —É–∂–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –≤ Xen, —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

`¬†#¬†xm¬†dmesg¬†|¬†grep¬†-i¬†iommu¬†-a2`
`(XEN)¬†Detected¬†3547.487¬†MHz¬†processor.`
`(XEN)¬†Initing¬†memory¬†sharing.`
`(XEN)¬†AMD-Vi:¬†IOMMU¬†0¬†Enabled.`
`(XEN)¬†I/O¬†virtualisation¬†enabled`
`(XEN)¬†¬†-¬†Dom0¬†mode:¬†Relaxed`

–î–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Intel —Ç–∞–º –±—É–¥—É—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ VT-d, –≤–º–µ—Å—Ç–æ AMD-Vi.

–ó–∞—Ç–µ–º, –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥–ª—é–∫–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å
—è–¥—Ä–∞ radeon –∏/–∏–ª–∏ fglrx –≤ blacklist, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å
–¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –Ω–∞ —Ö–æ—Å—Ç–µ, —Ç.–∫. –º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ –µ–µ –±—É–¥–µ–º
–æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –≥–æ—Å—Ç–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É, –∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ
–¥—Ä–∞–π–≤–µ—Ä–∞ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ—Å—Ç–µ–π. –ù—É–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å
–≤ —Ñ–∞–π–ª–µ /etc/modprobe.d/blacklist.conf :

`¬†¬†blacklist¬†fglrx`
`¬†¬†blacklist¬†radeon`

  - –µ—Å—Ç—å –Ω–µ–±–æ–ª—å—à–∞—è –ø—Ä–æ–±–ª–µ–º–∞, –µ—Å–ª–∏ –≤—Ç–æ—Ä–∞—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ -
    —Ç–æ–∂–µ AMD, —Ç–æ –ø—Ä–∏ —Ç–∞–∫–æ–º —Ä–∞—Å–∫–ª–∞–¥–µ –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –Ω–µ–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.
    –¢—É—Ç –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞: –ª–∏–±–æ –Ω–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å radeon/fglrx –≤
    blacklist, –ª–∏–±–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —ç—Ç–∏ –º–æ–¥—É–ª–∏ —É–∂–µ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ–π
    –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –∫ pci-stub, –ª–∏–±–æ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è udev. –¢–∞–∫ —á—Ç–æ, –≤
    —Å–ª—É—á–∞–µ –µ—Å–ª–∏ —É –≤–∞—Å –æ–±–µ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã AMD, —Ç–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –º–æ–¥—É–ª–∏ –≤
    blacklist –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã.

–¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É –∫ –ø—Ä–æ–±—Ä–æ—Å—É, –æ—Ç–∫–ª—é—á–∏–≤ –µ–µ –æ—Ç –¥—Ä–∞–π–≤–µ—Ä–∞
–Ω–∞ —Ö–æ—Å—Ç–µ –∏ –ø–æ–¥–∫–ª—é—á–∏–≤ –∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–º—É –Ω–∏—á–µ–≥–æ-–Ω–µ-–¥–µ–ª–∞—é—â–µ–º—É –¥—Ä–∞–π–≤–µ—Ä—É
pci-stub. –ï—Å–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç hdmi/displayport –≤–∏–¥–µ–æ–≤—ã—Ö–æ–¥—ã, —Ç–æ –Ω–∞
–≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∑–≤—É–∫–æ–≤–∞—è –∫–∞—Ä—Ç–∞, –µ–µ —Ç–∞–∫ –∂–µ –Ω—É–∂–Ω–æ
–ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ pci-stub. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ lspci:

`¬†¬†01:00.0¬†VGA¬†compatible¬†controller:¬†ATI¬†Technologies¬†Inc¬†PITCAIRN¬†[Radeon¬†HD¬†7800]`
`¬†¬†01:00.1¬†Audio¬†device:¬†ATI¬†Technologies¬†Inc¬†Device¬†aab0`

–ö–∞–∫ –º—ã –≤–∏–¥–∏–º, 01:00.0 - –≤–∏–¥–µ–æ—á–∏–ø, –∞ 01:00.1 - –∑–≤—É–∫–æ–≤–æ–π —á–∏–ø. –ó–∞—Ç–µ–º, –Ω–∞–º
–Ω—É–∂–Ω—ã vendor id –∏ device id. –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏–≤ lspci —Å –∫–ª—é—á–µ–º
-n

`¬†¬†01:00.0¬†0300:¬†1002:6818`
`¬†¬†01:00.1¬†0403:¬†1002:aab0`

–¢–µ–ø–µ—Ä—å –ø–æ–¥–∫–ª—é—á–∞–µ–º –∂–µ–ª–µ–∑–∫–∏ –∫ pci-stub

`¬†¬†#–≥–æ–≤–æ—Ä–∏–º¬†pci-stub,¬†—á—Ç–æ¬†–æ–Ω¬†–º–æ–∂–µ—Ç¬†—Ä–∞–±–æ—Ç–∞—Ç—å¬†—Å¬†–Ω–∞—à–µ–π¬†–≤–∏–¥–µ–æ–∫–∞—Ä—Ç–æ–π.`
`¬†¬†echo¬†"1002¬†6818"¬†>¬†/sys/bus/pci/drivers/pci-stub/new_id¬†`
`¬†¬†¬†#—Å–ª–µ–¥—É—é—â–∏–µ¬†—Å—Ç—Ä–æ—á–∫–∏¬†–æ—Ç–∫–ª—é—á–∞—Ç¬†–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É¬†–æ—Ç¬†—Ç–µ–∫—É—â–µ–≥–æ¬†–¥—Ä–∞–π–≤–µ—Ä–∞¬†–∏¬†–ø–æ–¥–∫–ª—é—á–∞—Ç¬†–µ–µ¬†–∫¬†pci-stub.`
`¬†¬†#–ï—Å–ª–∏¬†–≤—ã¬†—É–∂–µ¬†–ø—Ä–æ–ø–∏—Å–∞–ª–∏¬†–≤¬†blacklist¬†–º–æ–¥—É–ª–∏¬†radeon/fglrx,¬†—Ç–æ¬†—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ¬†–Ω–µ¬†–Ω—É–∂–Ω–æ¬†–æ—Ç–∫–ª—é—á–∞—Ç—å/–ø–æ–¥–∫–ª—é—á–∞—Ç—å¬†—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ,`
`¬†¬†#–ø–æ—ç—Ç–æ–º—É¬†–≤¬†–Ω–∏—Ö¬†–Ω–µ—Ç¬†–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.¬†–Ø–¥—Ä–æ¬†—Å–∞–º–æ¬†—É–≤–∏–¥–∏—Ç,¬†—á—Ç–æ¬†pci-stub¬†–º–æ–∂–µ—Ç¬†—Ä–∞–±–æ—Ç–∞—Ç—å¬†—Å¬†1002¬†6818¬†–∏¬†–ø–æ–¥–∫–ª—é—á–∏—Ç¬†–µ–≥–æ.`
`¬†¬†¬†echo¬†"0000:01:00.0"¬†>¬†/sys/bus/pci/devices/0000\:01\:00.0/driver/unbind¬†`
`¬†¬†echo¬†"0000:01:00.0"¬†>¬†/sys/bus/pci/drivers/pci-stub/bind`

`¬†¬†#–∑–≤—É–∫–æ–≤–∞—è¬†–∫–∞—Ä—Ç–∞`
`¬†¬†echo¬†"1002¬†aab0"¬†>¬†/sys/bus/pci/drivers/pci-stub/new_id¬†`
`¬†¬†echo¬†"0000:01:00.1"¬†>¬†/sys/bus/pci/devices/0000\:01\:00.1/driver/unbind¬†`
`¬†¬†echo¬†"0000:01:00.1"¬†>¬†/sys/bus/pci/drivers/pci-stub/bind`

–†–∞–∑—É–º–µ–µ—Ç—Å—è –ª—É—á—à–µ —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –≤–∏–¥–µ —Å–∫—Ä–∏–ø—Ç–∞, –ø–æ–¥—Å—Ç–∞–≤–∏–≤ –Ω—É–∂–Ω—ã–µ
–∑–Ω–∞—á–µ–Ω–∏—è.

–ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ—Å–º–æ—Ç—Ä–µ–≤ –≤—ã–≤–æ–¥ lspci -s 01:00.0 -k

`01:00.0¬†VGA¬†compatible¬†controller:¬†Advanced¬†Micro¬†Devices¬†[AMD]¬†nee¬†ATI¬†PITCAIRN¬†[Radeon¬†HD¬†7800]`
`¬†¬†¬†¬†¬†¬†¬†Subsystem:¬†Micro-Star¬†International¬†Co.,¬†Ltd.¬†Device¬†2740`
`¬†¬†¬†¬†¬†¬†¬†Kernel¬†driver¬†in¬†use:¬†pci-stub`
`¬†¬†¬†¬†¬†¬†¬†Kernel¬†modules:¬†radeon`

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä–∞–π–≤–µ—Ä
pci-stub, –∑–Ω–∞—á–∏—Ç –≤—Å–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –†–∞–∑—É–º–µ–µ—Ç—Å—è —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–Ω
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –¥–ª—è –∑–≤—É–∫–æ–≤–æ–π –∫–∞—Ä—Ç—ã.

-----

KVM.

–î–ª—è –Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å kvm –∏ –ø–æ –∂–µ–ª–∞–Ω–∏—é libvirt c
virt-manager, –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –≠—Ç–æ
–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –≤–∞—à–µ–≥–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞.

–ü–æ—Å–∫–æ–ª—å–∫—É AMD IOMMU(–∏–ª–∏ –¥—Ä–∞–π–≤–µ—Ä –≤ —è–¥—Ä–µ) –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Interrupt
Remapping, —Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–æ–¥—É–ª—é kvm –æ–ø—Ü–∏—é
allow_unsafe_assigned_interrupts=1. –ú–æ–∂–Ω–æ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –∑–∞–≥—Ä—É–∑–∏—Ç—å
–º–æ–¥—É–ª—å —Å –ø–æ–º–æ—â—å—é modprobe, –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤
/etc/modprobe.d/kvm.conf —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ—É–¥–ª—å.

`¬†¬†options¬†kvm¬†allow_unsafe_assigned_interrupts=1`

–¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ–º virt-manager –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –≤
–≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –∫–∞–∫ –æ–±—ã—á–Ω–æ. –ï—Å–ª–∏ —ç—Ç–æ Windows, —Ç–æ —Ä–∞–∑—É–º–µ–µ—Ç—Å—è
–Ω–µ–ø–ª–æ—Ö–æ –±—ã —Å–∫–∞—á–∞—Ç—å virtio –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö. –ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫
–û–° —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞, –º–æ–∂–Ω–æ –≤—ã–∫–ª—é—á–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –∏ –≤ virt-manager'e
–¥–æ–±–∞–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –≤ –º–æ–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ 0000:01:00.0 –∏
0000:01:00.1. –¢–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ–º –≥–æ—Å—Ç—è —Å–Ω–æ–≤–∞. –î–ª—è Windows –Ω—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å
–¥—Ä–∞–π–≤–µ—Ä–∞ —Å —Å–∞–π—Ç–∞ AMD –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ Windows
–º–æ–∂–µ—Ç –ª–µ–≥–∫–æ —É–π—Ç–∏ –≤ BSOD, —Ç–∞–∫ —á—Ç–æ –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞,
—Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –≥–æ—Å—Ç—è –≤–Ω–æ–≤—å –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –µ—â–µ. –ü–æ—Å–ª–µ
—É—Å—Ç–∞–Ω–æ–≤–∫–∏, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É.

  - –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, kvm –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –≥–æ—Å—Ç—è —Å –ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω–æ–π
    –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–æ–π –≤–µ—à–∞–µ—Ç –≤—Å—é —Å–∏—Å—Ç–µ–º—É, –ø–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ –≤—ã –≤—ã–∫–ª—é—á–∏–ª–∏
    –≤–∏—Ä—Ç—É–∞–ª–∫—É, —Ç–æ –ø—Ä–∏–¥–µ—Ç—Å—è —Ç–∞–∫ –∂–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–µ—Å—å –∫–æ–º–ø—å—é—Ç–µ—Ä.

–¢–µ–ø–µ—Ä—å, –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ –∫–æ–Ω—Å–æ–ª—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –æ—Ç–∫–ª—é—á–∏—Ç—Å—è –ø–æ—Å–ª–µ
–∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –≤ —Å–ª—É—á–∞–µ Windows 7 —Ç–∞–º –æ—Å—Ç–∞–µ—Ç—Å—è
–∫–∞—Ä—Ç–∏–Ω–∫–∞ "Starting Windows", –Ω–æ —Å–∞–º–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —É–∂–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è
–Ω–∞ –ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω—É—é –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É. –•–æ—Ç—è –Ω–∞ –∫–æ–Ω–æ—Å–ª—å –∏ –Ω–µ –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è
–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –æ–Ω–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç
—É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞ –∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≥–æ—Å—Ç–µ–º —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏
–º—ã—à–∏ –∫–∞–∫ –æ–±—ã—á–Ω—É—é –≤–∏—Ä—Ç—É–∞–ª–∫—É.

-----

XEN

–°–Ω–∞—á–∞–ª–∞, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è, –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∫—Å–µ–Ω –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç kvm, –∑–¥–µ—Å—å –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—Å—Ç—ã–ª–µ–π.

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —É –º–µ–Ω—è:

`kernel¬†=¬†"hvmloader"`
`builder='hvm'`
`memory¬†=¬†3096`
`name¬†=¬†"win7_x64"`
`vcpus=3`
`pae=1`
`acpi=1`
`apic=1`
`vif¬†=¬†[¬†'bridge=xenbr0'¬†]`
`disk¬†=¬†[¬†`
`'phy:/dev/md0,hda,w',`
`'`<file:/var/lib/libvirt/images/win7_x64_n_u.iso,hdb:cdrom,r>`'`
`]`
`xen_platform_pci=1`
`viridian=1`
`on_poweroff¬†=¬†'destroy'`
`on_reboot¬†¬†¬†=¬†'restart'`
`on_crash¬†¬†¬†¬†=¬†'destroy'`
`device_model¬†=¬†'qemu-dm'`
`boot='c'`
`sdl=0`
`vnc=1`
`vncconsole=0`
`stdvga=1`
`serial='pty'`
`pci¬†=¬†['01:00.0',¬†'01:00.1']`
`gfx_passthru=0`
`usbdevice="tablet"¬†¬†¬†¬†¬†¬†`

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∏—Å–∫–∞ –¥–ª—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è
mdraid –º–∞—Å—Å–∏–≤ /dev/md0, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–∞,
—Ç–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ disk, –≤–º–µ—Å—Ç–æ phy:/dev/md0 –Ω—É–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å
tap:aio:/path/to/file –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ <file:/path/to/file>

–ø–∞—Ä–∞–º–µ—Ç—Ä boot –≥–æ–≤–æ—Ä–∏—Ç xen'—É —Å —á–µ–≥–æ –≥—Ä—É–∑–∏—Ç—å—Å—è, "c" - –≥—Ä—É–∑–∏—Ç—å—Å—è —Å –¥–∏—Å–∫–∞,
"d" - —Å cdrom'–∞, —Ç–∞–∫ —á—Ç–æ –≤–Ω–∞—á–∞–ª–µ –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–º d, —á—Ç–æ–±—ã
—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –û–°.

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ—Å—Ç–∞–≤–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ–Ω—Ñ–∏–≥ –Ω–∞–¥–æ –∫—É–¥–∞ –Ω–∏–±—É–¥—å
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å.

–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ —Å—Ç–∞—Ä—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:

`xm¬†create¬†/path/to/vmconfig`

–ê –¥–ª—è –µ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å vncviewer, –∑–∞–ø—É—â–µ–Ω–Ω—ã–π –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

`vncviewer¬†:0`

–ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å kvm, –µ—Å–ª–∏ –≤—ã —Å—Ç–∞–≤–∏—Ç–µ Windows, —Ç–æ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å
–ø–∞—Ä–∞–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä–∞ –¥–ª—è Xen (GPLPV) –∏ –¥—Ä–∞–π–≤–µ—Ä Catalyst –¥–ª—è
–ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω–æ–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã.

  - —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ —Å kvm, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å—Ç–æ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
    Windows –≤ BSOD, —Å—É–¥—è –ø–æ –º–æ–µ–º—É –æ–ø—ã—Ç—É, –¥—Ä–∞–π–≤–µ—Ä–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è
    –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–æ–ª—å–∫–æ —Ä–∞–∑–∞ —Å —Ç—Ä–µ—Ç—å–µ–≥–æ.

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ, –Ω—É–∂–Ω–æ, —Ä–∞–∑—É–º–µ–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≥–æ—Å—Ç—è.
–ü–æ–≤–µ–¥–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ç–∞–∫–æ–µ –∂–µ –∫–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å kvm, —Ç.–µ. –Ω–∞ vnc –∫–æ–Ω—Å–æ–ª–∏
–∑–∞–º—Ä–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ —Å–æ–±—ã—Ç–∏—è –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–≤–æ–¥–∞ –æ–Ω–∞ –±—É–¥–µ—Ç
–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≥–æ—Å—Ç—é. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã –¥–æ–ª–∂–Ω–æ
–ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω—É—é –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É.

[**–û—Ö, —ç—Ç–æ –±—ã–ª–æ —á–µ—Ä—Ç–æ–≤—Å–∫–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ
\!**](http://ompldr.org/vZWVtbQ/fzu1ts3xw5uk.jpg) TODO: –ü—Ä–æ–±–ª–µ–º–∞ —Å–æ
–∑–≤—É–∫–æ–º, –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤–≤–æ–¥–∞, FLR, –û—Ç–∂–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±—Ä–∞—Ç–Ω–æ –∏–∑
–≤–∏—Ä—Ç—É–∞–ª–∫–∏, –ù—É –ø–æ —Ñ–∏–∫—Å—ã –ø–æ –º–µ–ª–æ—á–∏.