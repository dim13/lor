–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ø–æ—Å–æ–±—ã –æ–±—â–µ–Ω–∏—è —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –¥–µ–º–æ–Ω–æ–º HAL.

## –í–≤–µ–¥–µ–Ω–∏–µ

**HAL** (*Hardware Abstraction Layer*) - —ç—Ç–æ –¥–µ–º–æ–Ω, —Ö—Ä–∞–Ω—è—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö, –∏—Ö —Ç–∏–ø–∞—Ö, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –∏ –¥—Ä—É–≥—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é,
–∫–æ—Ç–æ—Ä—É—é –æ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —è–¥—Ä–∞. –î–µ–º–æ–Ω
–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–±
—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö, –Ω–µ–∂–µ–ª–∏ –ø—Ä—è–º–æ–µ –æ–±—â–µ–Ω–∏–µ —Å sysfs –∏ –¥—Ä. –ò—Å–ø–æ–ª—å–∑—É—è HAL API
–º—ã –º–æ–∂–µ—Ç –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –Ω–∞–π—Ç–∏ –≤ –Ω—ë–º
–¥–∏—Å–∫–æ–≤—ã–µ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–∏, Audio CD, USB —Ñ–ª–µ—à –∫–∞—Ä—Ç—ã, WiFi –∫–∞—Ä—Ç—ã,
–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, –º—ã—à–∏ –∏ —Ç.–¥. HAL —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–∑–Ω—ã—
—Å–∏–≥–Ω–∞–ª–æ–≤, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –º–æ–∂–µ–º –æ—Ç—Å–ª–µ–¥–∏—Ç—å –º–æ–º–µ–Ω—Ç
–ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Å–∏—Å—Ç–µ–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –±—ã–ª
–≤—Å—Ç–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π USB —Ñ–ª–µ—à –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å, DVD –¥–∏—Å–∫, –ø–æ–¥–Ω—è—Ç WiFi
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ —Ç.–¥.). HAL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫–∂–µ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ
–º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
[D-Bus](D-Bus "wikilink").

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä–æ–π HAL —Ö—Ä–∞–Ω–∏—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å
–∫–∞–∫ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤. –ö–ª—é—á–æ–º –≤ —ç—Ç–æ–º –º–∞—Å—Å–∏–≤–µ –±—É–¥–µ—Ç —è–≤–ª—è—Ç—å—Å—è —Ç.–Ω.
—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∏–ª–∏ **UDI**. –ó–Ω–∞—á–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ
–∫–ª—é—á–∞ –±—É–¥–µ—Ç –µ—â—ë –æ–¥–∏–Ω –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å
–∫–ª—é—á–æ–º –±—É–¥–µ—Ç –∏–º—è —Å–≤–æ–π—Å—Ç–≤–∞ –¥–∞–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º - –∑–Ω–∞—á–µ–Ω–∏–µ
—ç—Ç–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ò–º–µ–Ω–∞ UDI –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–∏—Å—Ç–µ–º—ã, –Ω–µ
—Å—Ç–æ–∏—Ç –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ –Ω–∏—Ö –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ. –ß—Ç–æ–±—ã –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–µ–π, –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º
—Ç–∞–∫—É—é —É–ø—Ä–æ—â—ë–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –Ω–µ–∫–æ–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

    <nowiki>
    UDI1
        |---block.device      /dev/sda1
        |---block.is_volume   1
        |---info.capabilities volume,block
        |---volume.label      WORK
        `---volume.uuid       0717-AD77
    UDI2
        ...
    UDI3
        ...
    </nowiki>

–ó–¥–µ—Å—å —É –Ω–µ–∫–æ–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å UDI, —Ä–∞–≤–Ω—ã–º –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–º—É UDI1, –∏–º–µ–µ—Ç—Å—è 5
—Å–≤–æ–π—Å—Ç–≤. –ò–º—è –∫–∞–∂–¥–æ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ —Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ. –ó–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞
–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–º–µ–Ω–∏. –î–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ UDI1 –º—ã –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å —Å–ª–µ–¥—É—â–µ–µ:

  - –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ block.device - —á—Ç–æ —ç—Ç–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω —Ñ–∞–π–ª
    */dev/sda1* –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ /dev;
  - –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ block.is_volume - —á—Ç–æ —ç—Ç–æ –Ω–µ–∫–∏–π —Ä–∞–∑–¥–µ–ª;
  - –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ info.capabilities - —á—Ç–æ —ç—Ç–æ —Ä–∞–∑–¥–µ–ª –Ω–∞ –±–ª–æ—á–Ω–æ–º
    —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;
  - –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ volume.label - —á—Ç–æ —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –∏–º–µ–µ—Ç –º–µ—Ç–∫—É *WORK*;
  - –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ volume.uuid - —á—Ç–æ —ç—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –∏–º–µ–µ—Ç UUID *0717-AD77*.

–ú—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é —Å–∏—Å—Ç–µ–º–Ω–æ–π —É—Ç–∏–ª–∏—Ç—ã *blkid*
(–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è *root*):

    <nowiki>
    # blkid | grep WORK
    /dev/sda1: LABEL="WORK" UUID="0717-AD77" TYPE="vfat"
    </nowiki>

–û–±—â–µ–Ω–∏–µ —Å HAL –¥–µ–º–æ–Ω–æ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ [D-Bus](D-Bus "wikilink"). –î–ª—è
D-Bus –∏–º–µ–µ—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–∏–Ω–¥–∏–Ω–≥–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —è–∑—ã–∫–æ–≤. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ
–¥–ª—è –æ–±—â–µ–Ω–∏—è —Å HAL —É –Ω–∞—Å –Ω–µ –¥–æ–ª–∂–Ω–æ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π. –í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ
–º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ø–æ—Å–æ–±–∞—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å HAL.

–¢–∞–∫–∂–µ –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ –Ω–∞ —à–∏–Ω–µ D-Bus –¥–µ–º–æ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –º–µ—Ç–æ–¥—ã
–¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ª—é–±—ã–º D-Bus –∫–ª–∏–µ–Ω—Ç–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é
*qdbusviewer* –∏–ª–∏ –ª—é–±—ã–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º (*qdbus*, *dbus-send*).

–ö–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä,
–∫–∞–∫ —à–∏–Ω–∞ USB –∏ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –∫ –Ω–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞).

–°—Ö–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ HAL –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
![Image:hal-arch.png](hal-arch.png "Image:hal-arch.png")

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–í–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö –¥–µ–º–æ–Ω HAL —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω,
–Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω. –î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —Ç–æ–ª—å–∫–æ
–∑–∞–≥–æ–ª–æ–≤–∫–∏ HAL –∏ D-Bus. –î–ª—è —Å–ø—Ä–∞–≤–∫–∏ –ø–æ HAL –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –ø–∞–∫–µ—Ç
*hal-doc*. –í Debian-–ø–æ–¥–æ–±–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∏—Ö –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–∫:

    <nowiki>
    # aptitude install libhal-dev libhal-storage-dev hal-doc
    </nowiki>

–¢–µ–ø–µ—Ä—å –º—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å HAL.

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤ –≤ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –≤–∏–¥–µ –º–æ–∂–Ω–æ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É *hal-device-manager*. –û–Ω–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤
Debian Etch, –Ω–æ –≤ –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö (–≤ —Ç.—á. –∏ –ø–æ—Å–ª–µ–¥–Ω–∏—
Ubuntu) —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å *gnome-device-manager*.

## –°–≤–æ–π—Å—Ç–≤–∞

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ–Ω–∞ —Å–≤–æ–π—Å—Ç–≤.

  - **info.capabilities** - —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫, –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –∏–∑ —Å–µ–±—è
    –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —ç—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. –≠—Ç–æ –≤–∞–∂–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è –æ—Ç–¥–µ–ª–µ–Ω–∏—è
    —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –ø–æ —Ç–∏–ø—É;
  - **info.parent** - —Å–æ–¥–µ—Ä–∂–∏—Ç UDI —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏
    HAL;
  - **block.device** - —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏
    (–Ω–∞–ø—Ä–∏–º–µ—Ä, /dev/sda1);
  - **block.is_volume** - —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ *true*, –µ—Å–ª–∏ –¥–∞–Ω–Ω–æ–µ
    —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ - —Ä–∞–∑–¥–µ–ª –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ;
  - **volume.fstype** - —Ç–∏–ø —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–¥–µ–ª–∞ (–µ—Å–ª–∏ —ç—Ç–æ —Ä–∞–∑–¥–µ–ª);
  - **volume.label** - –º–µ—Ç–∫–∞ —Ç–æ–º–∞;
  - **volume.fsusage** - –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (–æ–±—ã—á–Ω–∞—è
    —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞, RAID, –Ω–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∏ —Ç.–¥.);
  - **linux.sysfs_path** - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ sysfs.

–ó–∞ –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏–º—ë–Ω —Å–≤–æ–π—Å—Ç–≤ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ HAL.

## –ö–æ–Ω—Å–æ–ª—å

–ú—ã –º–æ–∂–µ–º –æ–±—â–∞—Ç—å—Å—è —Å HAL —Å –ø–æ–º–æ—â—å—é –ª—é–±–æ–≥–æ D-Bus –∫–ª–∏–µ–Ω—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å
–ø–æ–º–æ—â—å—é –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ *dbus-send*. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ —à–∏–Ω–µ
D-Bus –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å *org.freedesktop.Hal.Device*, –∫–æ—Ç–æ—Ä—ã–π
–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–≤–æ–π—Å—Ç–≤ –¥–∞–Ω–Ω–æ–≥–æ
–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

–ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏–º —Å–ø–∏—Å–æ–∫ –æ–±–ª—É–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–ø–æ—Ö–æ–∂–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–∞—Å—Ç
–∫–æ–º–∞–Ω–¥–∞ *lshal*):

    <nowiki>
    $ dbus-send --system --print-reply --dest=org.freedesktop.Hal \
                /org/freedesktop/Hal/Manager                      \
                org.freedesktop.Hal.Manager.GetAllDevices
    method return sender=:1.1 -> dest=:1.28 reply_serial=2
       array [
          string "/org/freedesktop/Hal/devices/acpi_P001"
          string "/org/freedesktop/Hal/devices/acpi_P002"
          ...
          string "/org/freedesktop/Hal/devices/pci_10de_368"
          string "/org/freedesktop/Hal/devices/pci_10de_362"
          string "/org/freedesktop/Hal/devices/pci_10de_369"
       ]
    </nowiki>

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ –æ—Ç–≤–µ—Ç–µ - —ç—Ç–æ UDI –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

–¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏–º —Å–≤–æ–π—Å—Ç–≤–æ *info.capabilities* –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–∑ –¥–∏—Å–∫–æ–≤—ã—
—Ä–∞–∑–¥–µ–ª–æ–≤, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –µ–≥–æ UDI:

    <nowiki>
    $ dbus-send --system --print-reply --dest=org.freedesktop.Hal  \
                /org/freedesktop/Hal/devices/volume_uuid_0717_AD77 \
                org.freedesktop.Hal.Device.GetProperty             \
                string:info.capabilities
    method return sender=:1.1 -> dest=:1.31 reply_serial=2
       array [
          string "volume"
          string "block"
       ]
    </nowiki>

–¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏–º —Å–≤–æ–π—Å—Ç–≤–æ *volume.label* (DOS –º–µ—Ç–∫–∞) –¥–ª—è —ç—Ç–æ–≥–æ –∂–µ —Ä–∞–∑–¥–µ–ª–∞:

    <nowiki>
    $ dbus-send --system --print-reply --dest=org.freedesktop.Hal  \
                /org/freedesktop/Hal/devices/volume_uuid_0717_AD77 \
                org.freedesktop.Hal.Device.GetProperty             \
                string:volume.label
    method return sender=:1.1 -> dest=:1.33 reply_serial=2
       string "WORK"
    </nowiki>

–ü–æ–ª—É—á–∏–º —Å–≤–æ–π—Å—Ç–≤–æ *volume.size* (—Ä–∞–∑–º–µ—Ä —Ä–∞–∑–¥–µ–ª–∞ –≤ –±–∞–π—Ç–∞—Ö) –¥–ª—è —ç—Ç–æ–≥–æ –∂–µ
—Ä–∞–∑–¥–µ–ª–∞:

    <nowiki>
    $ dbus-send --system --print-reply --dest=org.freedesktop.Hal  \
                /org/freedesktop/Hal/devices/volume_uuid_0717_AD77 \
                org.freedesktop.Hal.Device.GetProperty             \
                string:volume.size
    method return sender=:1.1 -> dest=:1.36 reply_serial=2
       uint64 15002878464
    </nowiki>

## C/C++

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –Ω–∞–ø–∏—à–µ–º HAL –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ libhal
(–Ω–∞ —è–∑—ã–∫–µ C, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ C99). –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ –¥–ª—è —Ç—É–ª–∫–∏—Ç–æ–≤,
–≥–¥–µ –Ω–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≥–æ D-Bus –∫–ª–∏–µ–Ω—Ç–∞, –ª–∏–±–æ –¥–ª—è —á–∏—Å—Ç–æ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–π
–ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É–ª–∫–∏—Ç—ã –≤–æ–æ–±—â–µ.

–ò—Ç–∞–∫, –≤—Å—ë —á—Ç–æ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è - —ç—Ç–æ –æ–¥–∏–Ω –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª –∏ —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π
—Å–∫—Ä–∏–ø—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏. Makefile –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é.

–°–∫—Ä–∏–ø—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (–Ω–∞–∑–æ–≤—ë–º –µ–≥–æ *mk*):

    <nowiki>
    #!/bin/sh

    # –∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω–∏–∫ main.c. –ù–µ –∑–∞–±—ã–≤–∞–µ–º –æ —Ñ–ª–∞–≥–∞—Ö –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö HAL –∏ D-Bus
    gcc -o hal -O2 -std=c99                                        \
            `pkg-config --cflags hal` `pkg-config --cflags dbus-1` \
            main.c                                                 \
            `pkg-config --libs hal` `pkg-config --libs dbus-1`
    </nowiki>

–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–µ–π—à–µ–≥–æ HAL –∫–ª–∏–µ–Ω—Ç–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É:

  - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π HAL –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ HAL API;
  - —Å–æ–∑–¥–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å D-Bus —Å–µ—Å—Å–∏–µ–π;
  - –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å HAL –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å D-Bus —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º;
  - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å HAL;
  - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ HAL API –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –¥–µ–º–æ–Ω–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä,
    –ø–æ–ª—É—á–∏–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤);
  - –¥–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å HAL –∫–ª–∏–µ–Ω—Ç–∞;

<!-- end list -->

    <nowiki>
    #include <stdio.h>
    #include <stdlib.h>

    #include <libhal.h>

    #include <dbus/dbus.h>

    // —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ UDI
    static void handleDevice(LibHalContext *ctx, const char *udi, DBusError *error)
    {
        if(!udi)
            return;

        printf("%s\n", udi);

        // –Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç —Ç–æ–ª—å–∫–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∏–º–µ—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–æ info.capabilities
        if(!libhal_device_property_exists(ctx, udi, "info.capabilities", NULL))
            return;

        // –ø–æ–ª—É—á–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ (–º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫)
        int i = 0;
        char **capabilities = libhal_device_get_property_strlist(ctx, udi, "info.capabilities", NULL);

        if(!capabilities)
            return;

        // —Å–µ–π—á–∞—Å 'capabilities' –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫

        // –ø—Ä–æ–π–¥—ë–º—Å—è –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º, –≤—ã–≤–µ–¥–µ–º –Ω–∞ —ç–∫—Ä–∞–Ω –∑–Ω–∞—á–µ–Ω–∏—è
        while(*(capabilities+i))
        {
            printf("\t%s\n", *(capabilities+i));
            ++i;
        }

        printf("\n");

        // –æ—Å–≤–æ–±–æ–¥–∏–º –ø–∞–º—è—Ç—å!
        libhal_free_string_array(capabilities);
    }

    static void die(const char *s)
    {
        if(s)
            fprintf(stderr, "%s\n", s);

        exit(1);
    }

    int main(int argc, char **argv)
    {
        DBusConnection *dbus;
        LibHalContext *ctx;
        DBusError error;

        // —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
        ctx = libhal_ctx_new();

        if(!ctx)
            die("Cannot initialize HAL context");

        // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç error, –æ–Ω –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö HAL API
        dbus_error_init(&error);

        // —Å–æ–∑–¥–∞—ë–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å D-Bus
        dbus = dbus_bus_get_private(DBUS_BUS_SYSTEM, &error);

        // –∞—Å—Å–æ—Ü–∏–∏—Ä—É–µ–º D-Bus —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å HAL –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
        libhal_ctx_set_dbus_connection(ctx, dbus);

        // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º HAL –∫–ª–∏–µ–Ω—Ç–∞ —Å –Ω–∞—à–µ–π —Å—Ç–æ—Ä–æ–Ω—ã
        if(!libhal_ctx_init(ctx, &error))
            die("Cannot initialize HAL");

        // —Å –ø–æ–º–æ—à—å—é HAL API –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º—ã—Ö –¥–µ–º–æ–Ω–æ–º,
        // –∫–∞–∂–¥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç—Ä–æ–∫—É —Å UDI
        int numDevices;
        char **halDevices = libhal_get_all_devices(ctx, &numDevices, NULL);

        // –Ω–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤??
        if(!halDevices)
            die("Cannot get device list");

        printf("Number of devices: %d\n", numDevices);

        // –¥–ª—è –∫–∞–∂–¥–æ–≥–æ UDI –≤—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏
        for(int i = 0;i < numDevices;i++)
            handleDevice(ctx, halDevices[i], &error);

        // –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–∞–º—è—Ç—å!
        libhal_free_string_array(halDevices);

        if(dbus_error_is_set(&error))
            dbus_error_free(&error);

        // –∑–∞–≤–µ—Ä—à–∞–µ–º D-Bus —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        dbus_connection_close(dbus);
        dbus_connection_unref(dbus);

        // –∑–∞–≤–µ—Ä—à–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞
        libhal_ctx_free(ctx);

        return 0;
    }
    </nowiki>

–≠—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–¥–∞—Å—Ç –Ω–∞ –∫–æ–Ω—Å–æ–ª—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏
—Å–≤–æ–π—Å—Ç–≤–æ *info.capabilities* –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

## Qt

–° –ø–æ–º–æ—â—å—é Qt –æ–±—â–∞—Ç—å—Å—è —Å HAL –º–æ–∂–Ω–æ –±–µ–∑ –æ—Å–æ–±—ã—Ö —Ç—Ä—É–¥–Ω–æ—Å—Ç–µ–π, —Ç.–∫. –≤ 4-—é
–≤–µ—Ä—Å–∏—é —ç—Ç–æ–≥–æ —Ç—É–ª–∫–∏—Ç–∞ —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω D-Bus –∫–ª–∏–µ–Ω—Ç (–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã
—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã *libqt4-dbus* –∏ *libqt4-dev*).

–°—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–µ–π—à–µ–≥–æ HAL –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ Qt –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞: —Å
–ø–æ–º–æ—â—å—é D-Bus –∫–ª–∏–µ–Ω—Ç–∞ Qt –ø–æ–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–∏—Å—Ç–µ–º–Ω–æ–π —à–∏–Ω–µ (–∏–º–µ–Ω–Ω–æ —Ç–∞–º
–∑–∞–ø—É—â–µ–Ω –¥–µ–º–æ–Ω HAL), –∏ –≤—ã–∑—ã–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ D-Bus –º–µ—Ç–æ–¥—ã. –í Qt –ø—Ä–∏–º–µ—Ä–µ
–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–≤–∞ –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã—Ö HAL -
*DeviceAdded* –∏ *DeviceRemoved*. –ü–µ—Ä–≤—ã–π —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è
–∫–∞–∫–æ–µ-–ª–∏–±–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –≤—Ç–æ—Ä–æ–π - –∫–æ–≥–¥–∞ —É–¥–∞–ª—è–µ—Ç—Å—è. –ù–∞–≥–ª—è–¥–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
–º–æ–≥—É—Ç –ø–æ—Å–ª—É–∂–∏—Ç—å USB —Ñ–ª–µ—à –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–∏ –∏–ª–∏ DVD –¥–∏—Å–∫–∏. –ö–æ–≥–¥–∞ —Ç–∞–∫–æ–π —Å–∏–≥–Ω–∞–ª
–≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã.
–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–∏ —Å–∏–≥–Ω–∞–ª—ã –º–æ–∂–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ —Ç–æ–≥–æ –∂–µ Qt.

    <nowiki>
    #include <QDBusConnection>
    #include <QDBusInterface>
    #include <QDBusReply>

    #include <QStringList>
    #include <QDebug>

    #include "hal.h"

    namespace
    {

    // —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑–æ–≤–∞ D-Bus –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
    template<typename T>
    T dbusRequest(QDBusInterface &i, const QString &method, const QString &param)
    {
        QDBusReply<T> reply = i.call(method, param);

        return reply.value();
    }

    }

    HAL::HAL() : QTextEdit()
    {
        resize(640, 480);

        /*
         *  –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏–≥–Ω–∞–ª—ã DeviceAdded –∏ DeviceRemoved –∑–∞ —Å–ª–µ–∂–µ–Ω–∏–µ–º
         *  –∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º/—É–¥–∞–ª–µ–Ω–∏–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –°–ª–µ–¥—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏,
         *  —Å–∫–∞–∂–µ–º, USB —Ñ–ª–µ—à–∫–∏, –≤ —Å–∏—Å—Ç–µ–º–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
         *  –û—Ç–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é –∞–Ω–∞–ª–∏–∑–∞
         *  –∏—Ö —Å–≤–æ–π—Å—Ç–≤.
         */
        QDBusConnection sys = QDBusConnection::systemBus();

        sys.connect("org.freedesktop.Hal",
                    "/org/freedesktop/Hal/Manager",
                    "org.freedesktop.Hal.Manager",
                    "DeviceAdded",
                    this,
                    SLOT(slotAdded(const QString &)));

        sys.connect("org.freedesktop.Hal",
                    "/org/freedesktop/Hal/Manager",
                    "org.freedesktop.Hal.Manager",
                    "DeviceRemoved",
                    this,
                    SLOT(slotRemoved(const QString &)));

        // –ø—Ä–æ—á–∏—Ç–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö UDI —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ –∑–∞–Ω–µ—Å—ë–º —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫
        // –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
        readDevices();
    }

    void HAL::readDevices()
    {
        // —Å –ø–æ–º–æ—â—å—é QDBusInterface —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å D-Bus —à–∏–Ω–æ–π
        QDBusInterface i("org.freedesktop.Hal",
                         "/org/freedesktop/Hal/Manager",
                         "org.freedesktop.Hal.Manager",
                         QDBusConnection::systemBus());

        // –≤—ã–∑—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π HAL –º–µ—Ç–æ–¥ - GetAllDevices. –≠—Ç–æ—Ç
        // –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±—Å–ª—É–∂–∏–≤–∞–µ–º—ã—Ö UDI –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ —Å—Ç—Ä–æ–∫
        QDBusReply<QStringList> reply = i.call("GetAllDevices");

        // –æ—Ç–≤–µ—Ç –±–∏—Ç—ã–π?
        if(reply.isValid())
        {
            // –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –∏–∑ –æ—Ç–≤–µ—Ç–∞
            QStringList l = reply.value();
            QStringList::iterator itEnd = l.end();

            // –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å–ø–∏—Å–∫—É —Å—Ç—Ä–æ–∫ (UDI) –∏ –∑–∞–Ω–æ—Å–∏–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É
            // –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
            for(QStringList::iterator it = l.begin();it != itEnd;++it)
                append(*it);
        }
        else
            append("Failed to get device list");
    }

    void HAL::slotAdded(const QString &udi)
    {
        /*
         *  –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ø—Ä–æ–±—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –æ–Ω–æ –∏–∑ —Å–µ–±—è
         *  –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç (–ø–æ–ø—Ä–æ–±—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä USB
         *  —Ñ–ª–µ—à –Ω–∞–∫–æ–ø–∏—Ç–µ–ª–∏ –∏–ª–∏ DVD –¥–∏—Å–∫–∏)
         */
        QDBusInterface i("org.freedesktop.Hal",
                         udi,
                         "org.freedesktop.Hal.Device",
                         QDBusConnection::systemBus());

        QStringList caps = dbusRequest<QStringList>(i, "GetProperty", "info.capabilities");

        qDebug() << "Added device with UDI" << udi << caps;

        // —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –∏–º–µ–µ—Ç —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, –æ–Ω–æ –Ω–∞—Å –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç
        if(dbusRequest<QString>(i, "GetProperty", "volume.fsusage") != "filesystem" &&
                !dbusRequest<bool>(i, "GetProperty", "volume.disc.has_audio"))
            return;

        QDBusMessage reply = i.call("GetProperty", "volume.size");

        // –ø–æ–ª—É—á–∞–µ–º –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
        QString product = dbusRequest<QString>(i, "GetProperty", "info.product");
        QString size = reply.arguments().first().toString();
        QString parent = dbusRequest<QString>(i, "GetProperty", "block.storage_device");

        // —Ä–æ–¥–∏—Ç–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–∞–∫ –º–æ–¥–µ–ª—å –∏ —à–∏–Ω—É,
        // –∫ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
        QDBusInterface iParent("org.freedesktop.Hal",
                    parent,
                    "org.freedesktop.Hal.Device",
                    QDBusConnection::systemBus());

        QString model = dbusRequest<QString>(iParent, "GetProperty", "storage.model");
        QString vendor = dbusRequest<QString>(iParent, "GetProperty", "storage.vendor");
        QString bus = dbusRequest<QString>(iParent, "GetProperty", "storage.bus");

        append(QString("Added device, model (%1), vendor (%2), bus (%3), product (%4), size (%5)")
                .arg(model).arg(vendor).arg(bus).arg(product).arg(size));
    }

    void HAL::slotRemoved(const QString &udi)
    {
        append(QString("Removed device with UDI %1").arg(udi));
    }
    </nowiki>

–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ DVD –¥–∏—Å–∫–∞, –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–∏–ø–∞
*"Added device, model (_NEC DVD_RW ND-3540A), vendor (), bus (ide),
product (–ú–æ–π –¥–∏—Å–∫), size (4644896768)"*:

![Image:hal-qt.png](hal-qt.png "Image:hal-qt.png")

## Tcl

–ù–µ –º–µ–Ω–µ–µ –ø—Ä–æ—Å—Ç–æ —á–µ–º –∏–∑ Qt, —Å HAL –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –∏–∑ Tcl. –ü—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ
–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–µ
[D-Bus](http://www.linux.org.ru/wiki/en/D-Bus#%D0%A0%D0%B0%D1%81%D1%81%D1%8B%D0%BB%D0%BA%D0%B0_%D1%81%D0%B8%D0%B3%D0%BD%D0%B0%D0%BB%D0%BE%D0%B2)

## –°—Å—ã–ª–∫–∏

  - [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    HAL](http://people.freedesktop.org/~david/hal-spec/hal-spec.html)
  - [–ü—Ä–∏–º–µ—Ä—ã Qt, C, Python](http://rusfolder.com/34174696)
  - \[<http://ru.wikipedia.org/wiki/HAL_(freedesktop.org>) –°—Ç–∞—Ç—å—è –Ω–∞
    Wikipedia\]

[Category:–°–∏—Å—Ç–µ–º–Ω–æ–µ –ü–û](Category:–°–∏—Å—Ç–µ–º–Ω–æ–µ_–ü–û "wikilink")
[Category:–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ](Category:–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ "wikilink")